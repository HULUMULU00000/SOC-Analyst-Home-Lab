# Расширенная конфигурация File Integrity Monitoring (FIM) для Windows

Этот документ описывает логику и причины выбора директорий, типов файлов и правил мониторинга, которые используются для расширения FIM в лаборатории Wazuh.  

---

## Цели расширения FIM

- Повысить эффективность обнаружения вредоносной активности на Windows.
- Контролировать директории, которые часто используются злоумышленниками.
- Обнаруживать появление и изменение исполняемых и скриптовых файлов.
- Проверить работу FIM на реальных сценариях поведения процесса Windows.

---

# Директории, добавленные в мониторинг

## 1. `C:\Users\*\AppData\Local\`

Эта директория часто используется приложениями для временных данных.
Вредоносные файлы также могут появляться здесь, поэтому её стоит включить в тестовый мониторинг.

---

## 2. `C:\ProgramData\`

В этой директории хранятся данные программ и службы Windows.
Иногда туда попадают исполняемые файлы, поэтому мониторинг поможет выявить подозрительные изменения.

---

## 3. `C:\Users\*\AppData\Local\Temp\`

Temp содержит временные файлы браузеров, установщиков и приложений.
Новые .exe или скрипты в этой папке могут быть полезными для анализа.

---

# Мониторируемые типы файлов

В расширенный мониторинг добавлены типы файлов, которые чаще всего используются во время атаки:

| Расширение | Почему отслеживается |
|-----------|-----------------------|
| **.exe**  | Основной тип исполняемых файлов в Windows. Появление новых .exe может помочь заметить установку приложений или подозрительных программ |
| **.dll**  | DLL-файлы часто меняются во время работы программ. Фиксация новых или изменённых .dll может быть полезной для анализа поведения приложений |
| **.ps1**  | PowerShell-скрипты активно используются для автоматизации. Их появление или изменение позволяет выявлять выполнение сценариев, которые стоит проверить |
| **.bat**  | Командные файлы применяются для запуска последовательностей команд. Новые .bat могут указывать на выполнение настроек или скриптов |


